<!--ф╝ЪшооходхИЧшбищб╡щЭв - Apple DesignщгОца╝-->
<view class="container fade-in">
  <!-- шЗкхоЪф╣Йхп╝шИкцаП -->
  <view class="custom-navbar" style="padding-top: {{statusBarHeight}}px;">
    <view class="navbar-content" style="height: {{customNavBarHeight}}px;">
      <text class="navbar-title">ф╝ЪшооходхИЧшби</text>
      <view class="navbar-right-icons" style="right: {{menuButtonInfo.width + 20}}px;">
        <image 
          class="navbar-icon" 
          src="/images/icons/search.svg" 
          bindtap="goToSearchPage"
          mode="aspectFit"
        ></image>
        <image 
          class="navbar-icon" 
          src="/images/icons/user.svg" 
          bindtap="goToMyBookings"
          mode="aspectFit"
        ></image>
        <!-- чобчРЖхСШхЫ╛цаЗчз╗хИ░х║ХщГиц╡охКицМЙщТоя╝МщБ┐хЕНцЛецМд -->
      </view>
    </view>
  </view>

  <!-- цРЬч┤вхТМчнЫщАЙхМ║хЯЯ - хР╕щб╢цХИцЮЬ -->
  <view class="search-filter-area sticky-header" style="top: {{statusBarHeight + customNavBarHeight}}px;">
    <view class="search-input-wrapper">
      <image class="search-icon-in-input" src="/images/icons/search-grey.svg" mode="aspectFit"></image>
      <input
        class="search-input"
        placeholder="цРЬч┤вф╝ЪшооходхРНчз░цИЦцППш┐░"
        placeholder-class="search-placeholder"
        confirm-type="search"
        bindinput="onSearchInput"
        bindconfirm="onSearchConfirm"
        value="{{searchKeyword}}"
      />
    </view>
    <view class="filter-button" bindtap="showFilterOptions">
      <image class="filter-icon" src="/images/icons/filter.svg" mode="aspectFit"></image>
    </view>
  </view>

  <!-- ф╝ЪшооходхИЧшбихМ║хЯЯ -->
  <scroll-view
    class="room-list-scroll-view"
    scroll-y
    bindscrolltolower="onReachBottom"
    wx:if="{{!loading && rooms.length > 0}}"
  >
    <view wx:for="{{rooms}}" wx:key="id" class="room-card-wrapper slide-in-up" style="animation-delay: {{index * 0.05}}s;">
      <view
        class="room-card overlay-card enhanced-shadow"
        data-room-id="{{item.id || item.roomId || item._id}}"
        bindtap="goToRoomDetail"
      >
        <!-- шГМцЩпхЫ╛чЙЗх▒В -->
        <view class="room-background-container">
          <image 
            wx:if="{{!item.imageError}}"
            class="room-background-image" 
            src="{{item.displayImage}}" 
            mode="aspectFill" 
            lazy-load
            binderror="onImageError"
            bindload="onImageLoad"
            data-room-id="{{item.id}}"
          ></image>
          <view wx:else class="room-background-placeholder">
            <image 
              class="room-default-background" 
              src="/images/default_room.svg" 
              mode="aspectFill"
            ></image>
          </view>
          <!-- хКаш╜╜чК╢цАБ -->
          <view wx:if="{{item.imageLoading}}" class="background-loading-overlay">
            <image class="background-loading-spinner" src="/images/loading.svg" mode="aspectFit"></image>
          </view>
        </view>

        <!-- ц╕РхПШщБоч╜йх▒В -->
        <view class="room-gradient-overlay"></view>

        <!-- чК╢цАБшзТцаЗ -->
        <view class="room-status-badge {{item.status === 'available' ? 'badge-available' : 'badge-unavailable'}}">
          <text class="badge-text">
            {{item.status === 'available' ? 'хПпщвДч║ж' : 'х╖▓ч║жц╗б'}}
          </text>
        </view>

        <!-- х║ХщГиф┐бцБпхПах▒ВхНбчЙЗ -->
        <view class="room-info-overlay">
          <view class="room-info-content">
            <text class="room-name-overlay">{{item.name}}</text>
            
            <view class="room-meta-overlay">
              <view class="meta-item">
                <text class="meta-icon">ЁЯСе</text>
                <text class="meta-text">{{item.capacity}}ф║║</text>
              </view>
              <view class="meta-item">
                <text class="meta-icon">ЁЯУН</text>
                <text class="meta-text">{{item.location}}</text>
              </view>
            </view>
            
            <text class="room-description-overlay" style="-webkit-line-clamp: 2;">
              {{item.description || 'цЪВцЧацППш┐░'}}
            </text>
          </view>
        </view>
      </view>
    </view>

    <!-- хКаш╜╜цЫ┤хдЪцПРчд║ -->
    <view wx:if="{{loadingMore}}" class="loading-more">
      <image class="loading-more-spinner" src="/images/loading.svg" mode="aspectFit"></image>
      <text class="loading-more-text">хКаш╜╜ф╕н...</text>
    </view>
  </scroll-view>

  <!-- щб╡щЭвхКаш╜╜чК╢цАБ -->
  <view wx:if="{{loading}}" class="loading-overlay">
    <image class="loading-spinner" src="/images/loading.svg" mode="aspectFit"></image>
    <text class="loading-text">хКаш╜╜ф╕ня╝Мшп╖чиНхАЩ...</text>
  </view>

  <!-- цЧаф╝ЪшооходцХ░цНохНаф╜Нчмж -->
  <view wx:elif="{{!loading && rooms.length === 0}}" class="no-rooms-placeholder">
    <image class="empty-icon" src="/images/icons/empty.svg" mode="aspectFit"></image>
    <text class="empty-text">{{searchKeyword ? 'цК▒цнЙя╝Мц▓бцЬЙцЙ╛хИ░чмжхРИцЭбф╗╢чЪДф╝Ъшооход' : 'цЪВцЧаф╝ЪшооходцХ░цНо'}}</text>
    <text class="empty-subtext">{{searchKeyword ? 'шп╖х░ЭшпХхЕ╢ф╗ЦхЕ│щФошпН' : 'ф╕ЛцЛЙхИ╖цЦ░цИЦшБФч│╗чобчРЖхСШц╖╗хКа'}}</text>
    <view wx:if="{{searchKeyword}}" class="clear-search-button" bindtap="clearSearch">
      <text class="clear-search-text">ц╕ЕщЩдцРЬч┤в</text>
    </view>
  </view>

  <!-- чобчРЖхСШхЕехПгцМЙщТо - AppleщгОца╝хЬЖх╜вц╡охКицМЙщТо -->
  <view wx:if="{{isAdmin && !loading}}" class="admin-entry-wrapper">
    <view class="admin-entry-button enhanced-admin-button" bindtap="goToAdminPanel">
      <image class="admin-icon" src="/images/icons/admin.svg" mode="aspectFit"></image>
    </view>
  </view>
</view> 