# 会议室预订系统 - 微信小程序版本

## 📋 项目概述

这是一个基于微信小程序的会议室预订系统，采用前后端分离架构，提供便捷的会议室预约和管理功能。

### 系统架构
- **前端**: 微信小程序 (WXML, WXSS, JavaScript)
- **后端**: Node.js + Express + MongoDB
- **部署**: PM2 + Nginx + HTTPS
- **服务器**: 47.122.68.192 (www.cacophonyem.me)

## 🚀 快速开始

### 前端开发
1. 安装微信开发者工具
2. 导入 `/frontend` 目录作为小程序项目
3. 配置AppID和服务器域名
4. 运行测试

### 后端部署
```bash
# 进入服务器
ssh root@47.122.68.192

# 更新代码
cd /root/meeting-backend
git pull origin main

# 安装依赖
npm install

# 重启服务
pm2 restart meeting-backend

# 查看状态
pm2 status
```

## 📁 项目结构

```
meeting/
├── frontend/                # 微信小程序前端
│   ├── pages/              # 页面文件
│   │   ├── roomList/       # 会议室列表 (精简版)
│   │   ├── roomDetail/     # 会议室详情 (精简版)
│   │   └── admin/          # 管理员页面 (精简版)
│   ├── utils/              # 工具函数
│   │   ├── request.js      # 网络请求工具 (精简版)
│   │   └── auth.js         # 认证工具
│   └── app.js              # 应用入口
├── backend/                # Node.js后端
└── docs/                   # 项目文档
```

## 🔧 核心功能

### 用户功能
- **会议室浏览**: 查看所有可用会议室
- **时间段预约**: 支持整时段或自定义时间预约
- **搜索筛选**: 按名称、容量、设备筛选会议室
- **预约管理**: 查看和管理个人预约记录

### 管理员功能
- **会议室管理**: 增加、编辑、删除会议室
- **预约审核**: 查看和管理所有预约记录
- **系统配置**: 管理系统参数和权限

## 🎨 界面设计

### 会议室详情页 - 双层时间选择
- **时段卡片**: 上午/中午/下午时段总览
- **时间网格**: 展开后显示详细时间段
- **预约模式**: 
  - 整时段预约：一键预约整个时段
  - 自定义预约：选择具体时间范围

### 设计特色
- Apple Card风格界面
- 流畅的展开/收起动画
- 直观的可用性状态指示
- 响应式触摸反馈

## ⚡ 性能优化

### 代码精简
- 移除冗余的调试日志
- 简化错误处理逻辑
- 优化网络请求工具
- 减少不必要的方法和变量

### 核心文件优化
- `roomDetail.js`: 从 1400+ 行精简至 300+ 行
- `request.js`: 从 400+ 行精简至 70+ 行
- `admin.js`: 从 1200+ 行精简至 250+ 行
- `roomList.js`: 从 950+ 行精简至 150+ 行

## 📱 使用说明

### 普通用户
1. 打开小程序，浏览会议室列表
2. 点击会议室进入详情页
3. 选择日期和时间段
4. 填写预约信息提交

### 管理员
1. 在会议室列表页点击"管理"按钮
2. 切换到管理员面板
3. 管理会议室和预约记录

## 🛠️ 技术特性

### 兼容性处理
- 支持iOS和Android设备
- 处理微信小程序API限制
- 优雅降级处理网络异常

### 数据管理
- 本地存储用户信息
- 智能缓存机制
- 离线数据同步

## 📊 API接口

### 用户相关
- `POST /api/user/wechat-login` - 微信登录
- `GET /api/user/admin-status` - 获取管理员状态

### 会议室相关
- `GET /api/rooms` - 获取会议室列表
- `GET /api/rooms/:id` - 获取会议室详情
- `GET /api/rooms/:id/availability` - 获取可用时间段

### 预约相关
- `POST /api/bookings` - 创建预约
- `GET /api/bookings/admin` - 管理员获取预约列表
- `PUT /api/bookings/:id/cancel` - 取消预约

## 🚨 注意事项

### 开发环境
- 确保后端服务正常运行
- 配置正确的API域名
- 测试网络连接状态

### 生产环境
- 使用HTTPS协议
- 定期备份数据
- 监控服务器状态

## 🔄 部署流程

### 自动化部署
```bash
# 提交代码
git add .
git commit -m "feat: 功能描述"
git push origin main

# 服务器部署
ssh root@47.122.68.192
cd /root/meeting-backend
git pull origin main
npm install
pm2 restart meeting-backend
```

### 验证部署
```bash
# 检查服务状态
pm2 status
pm2 logs meeting-backend --lines 20

# 验证API
curl https://www.cacophonyem.me/meeting/api/health
```

## 📈 项目优势

1. **代码质量**: 精简高效，易于维护
2. **用户体验**: 流畅直观的交互设计
3. **系统稳定**: 健壮的错误处理机制
4. **扩展性强**: 模块化架构便于扩展
5. **部署简单**: 自动化部署流程

## 🔧 故障排除

### 常见问题
1. **登录失败**: 检查网络连接和API服务状态
2. **数据加载慢**: 确认服务器响应时间
3. **预约失败**: 验证用户权限和时间段可用性

### 调试建议
- 查看小程序控制台日志
- 检查网络请求状态
- 验证服务器日志记录

---

*最后更新: 2024年*
